diff --git a/CMakeLists.txt b/CMakeLists.txt
index 438f72d099..65db292151 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -629,6 +629,8 @@ set(ANDROID_QEMU_arm_DEVICES_darwin-x86_64
 # TODO: unstub the hvf for darwin on arm
 set(ANDROID_QEMU_arm_DEVICES_darwin-aarch64
     "accel/stubs/hax-stub.c;${ANDROID_QEMU_ARM_DEVICES}")
+set(ANDROID_QEMU_i386_DEVICES_darwin-aarch64
+    "hw/i386/acpi-build.c;${ANDROID_QEMU_COMMON_DEVICES}")
 target_compile_definitions(android-qemu-deps INTERFACE "-DANDROID_IO")
 android_target_compile_options(
   android-qemu-deps
@@ -904,6 +906,14 @@ if(NOT OPTION_AEMU_LIBS_ONLY)
       aarch64 "${ANDROID_QEMU_arm_DEVICES_${ANDROID_TARGET_TAG}}")
     android_add_qemu_headless_executable(
       aarch64 "${ANDROID_QEMU_arm_DEVICES_${ANDROID_TARGET_TAG}}")
+    android_add_qemu_executable(
+      i386 "${ANDROID_QEMU_i386_DEVICES_${ANDROID_TARGET_TAG}}")
+    android_add_qemu_headless_executable(
+      i386 "${ANDROID_QEMU_i386_DEVICES_${ANDROID_TARGET_TAG}}")
+    android_add_qemu_executable(
+      x86_64 "${ANDROID_QEMU_i386_DEVICES_${ANDROID_TARGET_TAG}}")
+    android_add_qemu_headless_executable(
+      x86_64 "${ANDROID_QEMU_i386_DEVICES_${ANDROID_TARGET_TAG}}")
 
   if(NOT OPTION_MINBUILD)
     android_add_qemu_executable(
diff --git a/android-qemu2-glue/config/target-x86/config-target.h b/android-qemu2-glue/config/target-x86/config-target.h
index 76bc1ae2d1..294d9bccac 100644
--- a/android-qemu2-glue/config/target-x86/config-target.h
+++ b/android-qemu2-glue/config/target-x86/config-target.h
@@ -21,7 +21,8 @@
 
 #ifdef __APPLE__
 
-#define CONFIG_HVF 1
+//#define CONFIG_HVF 0
+#undef CONFIG_HVF  
 
 #endif // __APPLE__
 
diff --git a/android-qemu2-glue/config/target-x86_64/config-target.h b/android-qemu2-glue/config/target-x86_64/config-target.h
index 93b388cd11..575eba127a 100644
--- a/android-qemu2-glue/config/target-x86_64/config-target.h
+++ b/android-qemu2-glue/config/target-x86_64/config-target.h
@@ -20,7 +20,8 @@
 
 #ifdef __APPLE__
 
-#define CONFIG_HVF 1
+//#define CONFIG_HVF 1
+#undef CONFIG_HVF
 
 #endif // __APPLE__
 
diff --git a/android/build/cmake/android.cmake b/android/build/cmake/android.cmake
index f5781981b6..5b2ed65d6d 100644
--- a/android/build/cmake/android.cmake
+++ b/android/build/cmake/android.cmake
@@ -1449,6 +1449,10 @@ function(android_build_qemu_variant)
                              PRIVATE ${qemu_build_DEFINITIONS})
   target_link_libraries(${qemu_build_EXE} PRIVATE ${QEMU_COMPLETE_LIB}
                                                   ${qemu_build_LIBRARIES})
+  if(DARWIN_AARCH64 AND NOT (ANDROID_AARCH STREQUAL "aarch64")) 
+    target_compile_options(${qemu_build_EXE} PRIVATE -UCONFIG_HVF)
+  endif()
+
 
   # Make the common dependency explicit, as some generators might not detect it
   # properly (Xcode/MSVC native)
diff --git a/android/emulator/CMakeLists.txt b/android/emulator/CMakeLists.txt
index 294fb5386f..d893724a5b 100644
--- a/android/emulator/CMakeLists.txt
+++ b/android/emulator/CMakeLists.txt
@@ -18,7 +18,14 @@ target_compile_definitions(
 
 # Make sure we have the qemu dependencies available
 if(BUILDING_FOR_AARCH64)
-  add_dependencies(emulator qemu-system-aarch64 qemu-system-aarch64-headless)
+  add_dependencies(
+    emulator 
+    qemu-system-aarch64 
+    qemu-system-aarch64-headless
+    qemu-system-i386
+    qemu-system-i386-headless
+    qemu-system-x86_64
+    qemu-system-x86_64-headless)
 elseif(OPTION_MINBUILD)
   add_dependencies(emulator qemu-system-x86_64 qemu-system-aarch64
                    qemu-system-x86_64-headless qemu-system-aarch64-headless)
diff --git a/android/emulator/main-emulator.cpp b/android/emulator/main-emulator.cpp
index 29edad0757..a0b42affac 100644
--- a/android/emulator/main-emulator.cpp
+++ b/android/emulator/main-emulator.cpp
@@ -898,11 +898,6 @@ int main(int argc, char** argv)
           if (sarch == "arm64" && apiLevel >=28) {
               APANIC("Avd's CPU Architecture '%s' is not supported by the QEMU2 emulator on x86_64 host.\n", avdarch);
           }
-#endif
-#if defined(__aarch64__)
-          if (sarch != "arm64") {
-              APANIC("Avd's CPU Architecture '%s' is not supported by the QEMU2 emulator on aarch64 host.\n", avdarch);
-          }
 #endif
       }
     }
diff --git a/android/scripts/unix/build-qemu-android.sh b/android/scripts/unix/build-qemu-android.sh
index 798583beab..246f7fb641 100755
--- a/android/scripts/unix/build-qemu-android.sh
+++ b/android/scripts/unix/build-qemu-android.sh
@@ -207,14 +207,6 @@ build_qemu_android () {
         var_append QEMU_TARGET_BUILDS "$QEMU_TARGET-softmmu/qemu-system-$QEMU_TARGET$(builder_host_exe_extension)"
     done
 
-    case $1 in
-        darwin-aarch64)
-            QEMU_TARGETS="aarch64"
-            QEMU_TARGET_LIST="aarch64-softmmu"
-            QEMU_TARGET_BUILDS="aarch64-softmmu/qemu-system-aarch64"
-            ;;
-    esac
-
     dump "$(builder_text) Building qemu-android"
     log "Qemu targets: $QEMU_TARGETS"
 
diff --git a/android/scripts/unix/gen-android-sdk-toolchain.sh b/android/scripts/unix/gen-android-sdk-toolchain.sh
index a8a2b32254..429cdc0976 100755
--- a/android/scripts/unix/gen-android-sdk-toolchain.sh
+++ b/android/scripts/unix/gen-android-sdk-toolchain.sh
@@ -524,7 +524,7 @@ prepare_build_for_darwin() {
     OSX_DESIRED=12.2
 
     # This is the list of supported SDKs,
-    OSX_SDK_SUPPORTED="${OSX_REQUIRED} 10.15 10.16 11.0 11.1 11.2 11.3 11.4 11.5 11.6 12.0"
+    OSX_SDK_SUPPORTED="${OSX_REQUIRED} 10.15 10.16 11.0 11.1 11.2 11.3 11.4 11.5 11.6 12.0 12.1"
     OSX_XCODE=$(xcodebuild -version | tr '\n' ' ')
     OSX_SDK_INSTALLED_LIST=$(xcodebuild -showsdks 2>/dev/null | \
             egrep --color=never -o " macosx\d+.\d+$" | sed -e "s/.*macosx//g" | sort -n | \
@@ -809,7 +809,7 @@ prepare_build_for_darwin_aarch64() {
 
     OSX_VERSION=$(sw_vers -productVersion)
     OSX_DEPLOYMENT_TARGET=10.16
-    OSX_SDK_SUPPORTED="10.11 10.12 10.13 10.14 10.15 10.16 11.0 11.1 11.2 11.3 11.4 11.5 11.6 12.0"
+    OSX_SDK_SUPPORTED="10.11 10.12 10.13 10.14 10.15 10.16 11.0 11.1 11.2 11.3 11.4 11.5 11.6 12.0 12.1"
     OSX_SDK_INSTALLED_LIST=$(xcodebuild -showsdks 2>/dev/null | \
             grep --color=never macosx | sed -e "s/.*macosx10\.//g" | sort -n | \
             sed -e 's/^/10./g' | tr '\n' ' ')
diff --git a/android/scripts/unix/utils/common.shi b/android/scripts/unix/utils/common.shi
index 3f1ddd89b0..4d16b03de0 100644
--- a/android/scripts/unix/utils/common.shi
+++ b/android/scripts/unix/utils/common.shi
@@ -295,6 +295,9 @@ get_build_arch () {
         case $(get_build_os) in
             darwin)
                 _SHU_BUILD_ARCH=$(uname -m)
+                if [ "$_SHU_BUILD_ARCH" == "arm64" ]; then
+                    _SHU_BUILD_ARCH="aarch64"
+                fi 
                 ;;
             linux)
                 _SHU_BUILD_ARCH=$(uname -m)
diff --git a/cmake-main.darwin-aarch64.inc b/cmake-main.darwin-aarch64.inc
index f9b3d320bb..d458f41c5b 100644
--- a/cmake-main.darwin-aarch64.inc
+++ b/cmake-main.darwin-aarch64.inc
@@ -7,6 +7,8 @@
 #   libqemuutil
 #   qemu-img
 #   qemu-system-aarch64
+#   qemu-system-i386
+#   qemu-system-x86_64
 
 ## TARGET: qemu2-shared ##
 set(qemu2-shared_sources ""
@@ -129,7 +131,6 @@ crypto/xts.c
 device-hotplug.c
 device_tree.c
 disas/arm-a64.cc
-disas/arm.c
 disas/libvixl/vixl/a64/decoder-a64.cc
 disas/libvixl/vixl/a64/disasm-a64.cc
 disas/libvixl/vixl/a64/instructions-a64.cc
@@ -137,42 +138,27 @@ disas/libvixl/vixl/compiler-intrinsics.cc
 disas/libvixl/vixl/utils.cc
 dma-helpers.c
 hmp.c
-hw/acpi/acpi-stub.c
 hw/acpi/acpi_interface.c
 hw/acpi/aml-build.c
 hw/acpi/bios-linker-loader.c
-hw/acpi/ipmi-stub.c
 hw/audio/ac97.c
 hw/audio/es1370.c
 hw/audio/goldfish_audio.c
 hw/audio/hda-codec.c
 hw/audio/intel-hda.c
-hw/audio/lm4549.c
-hw/audio/marvell_88w8618.c
-hw/audio/pl041.c
 hw/audio/soundhw.c
-hw/audio/wm8750.c
 hw/block/block.c
 hw/block/cdrom.c
-hw/block/ecc.c
 hw/block/hd-geometry.c
-hw/block/m25p80.c
-hw/block/nand.c
 hw/block/nvme.c
-hw/block/onenand.c
 hw/block/pflash_cfi01.c
-hw/block/pflash_cfi02.c
 hw/bt/core.c
 hw/bt/hci-csr.c
 hw/bt/hci.c
 hw/bt/hid.c
 hw/bt/l2cap.c
 hw/bt/sdp.c
-hw/char/cadence_uart.c
-hw/char/cmsdk-apb-uart.c
-hw/char/imx_serial.c
 hw/char/ipoctal232.c
-hw/char/pl011.c
 hw/char/serial-isa.c
 hw/char/serial-pci.c
 hw/char/serial.c
@@ -185,8 +171,6 @@ hw/core/loader.c
 hw/core/machine.c
 hw/core/nmi.c
 hw/core/or-irq.c
-hw/core/platform-bus.c
-hw/core/ptimer.c
 hw/core/qdev-fw.c
 hw/core/qdev-properties-system.c
 hw/core/qdev-properties.c
@@ -194,95 +178,40 @@ hw/core/qdev.c
 hw/core/register.c
 hw/core/reset.c
 hw/core/split-irq.c
-hw/core/stream.c
 hw/core/sysbus.c
 hw/cpu/core.c
-hw/display/ads7846.c
-hw/display/blizzard.c
 hw/display/edid-generate.c
-hw/display/exynos4210_fimd.c
 hw/display/framebuffer.c
 hw/display/goldfish_fb.c
-hw/display/pl110.c
-hw/display/sii9022.c
-hw/display/ssd0303.c
-hw/display/ssd0323.c
-hw/display/tc6393xb.c
 hw/display/vga-pci.c
-hw/dma/pl080.c
-hw/dma/pl330.c
-hw/dma/xilinx_axidma.c
-hw/dma/xlnx-zynq-devcfg.c
-hw/gpio/gpio_key.c
-hw/gpio/max7310.c
-hw/gpio/pl061.c
-hw/gpio/zaurus.c
-hw/i2c/aspeed_i2c.c
-hw/i2c/bitbang_i2c.c
 hw/i2c/core.c
-hw/i2c/exynos4210_i2c.c
-hw/i2c/i2c-ddc.c
-hw/i2c/imx_i2c.c
 hw/i2c/smbus.c
 hw/i2c/smbus_eeprom.c
-hw/i2c/versatile_i2c.c
-hw/ide/ahci-allwinner.c
 hw/ide/ahci.c
 hw/ide/atapi.c
 hw/ide/core.c
 hw/ide/ich.c
-hw/ide/microdrive.c
 hw/ide/pci.c
 hw/ide/qdev.c
 hw/input/hid.c
-hw/input/lm832x.c
-hw/input/pl050.c
 hw/input/ps2.c
-hw/input/stellaris_input.c
-hw/input/tsc2005.c
 hw/input/virtio-input-hid.c
 hw/input/virtio-input.c
-hw/intc/arm_gic.c
-hw/intc/arm_gic_common.c
-hw/intc/arm_gicv2m.c
-hw/intc/arm_gicv3.c
-hw/intc/arm_gicv3_common.c
-hw/intc/arm_gicv3_dist.c
-hw/intc/arm_gicv3_its_common.c
-hw/intc/arm_gicv3_redist.c
-hw/intc/imx_avic.c
-hw/intc/imx_gpcv2.c
 hw/intc/intc.c
-hw/intc/pl190.c
-hw/intc/realview_gic.c
-hw/intc/xlnx-pmu-iomod-intc.c
-hw/intc/xlnx-zynqmp-ipi.c
 hw/ipack/ipack.c
 hw/ipack/tpci200.c
 hw/isa/isa-bus.c
 hw/isa/isa-superio.c
 hw/isa/smc37c669-superio.c
-hw/misc/a9scu.c
-hw/misc/arm11scu.c
-hw/misc/arm_integrator_debug.c
-hw/misc/arm_l2x0.c
 hw/misc/edu.c
-hw/misc/max111x.c
 hw/misc/pci-testdev.c
-hw/misc/tmp105.c
-hw/misc/tmp421.c
 hw/misc/unimp.c
 hw/misc/vmcoreinfo.c
-hw/net/allwinner_emac.c
-hw/net/cadence_gem.c
 hw/net/can/can_kvaser_pci.c
 hw/net/can/can_mioe3680_pci.c
 hw/net/can/can_pcm3680_pci.c
 hw/net/can/can_sja1000.c
 hw/net/eepro100.c
-hw/net/ftgmac100.c
-hw/net/imx_fec.c
-hw/net/lan9118.c
 hw/net/ne2000.c
 hw/net/net_rx_pkt.c
 hw/net/net_tx_pkt.c
@@ -294,10 +223,6 @@ hw/net/rocker/rocker_fp.c
 hw/net/rocker/rocker_of_dpa.c
 hw/net/rocker/rocker_world.c
 hw/net/rtl8139.c
-hw/net/smc91c111.c
-hw/net/stellaris_enet.c
-hw/net/xgmac.c
-hw/net/xilinx_axienet.c
 hw/nvram/chrp_nvram.c
 hw/nvram/eeprom93xx.c
 hw/nvram/eeprom_at24c.c
@@ -310,10 +235,7 @@ hw/pci-bridge/pcie_pci_bridge.c
 hw/pci-bridge/pcie_root_port.c
 hw/pci-bridge/xio3130_downstream.c
 hw/pci-bridge/xio3130_upstream.c
-hw/pci-host/designware.c
-hw/pci-host/gpex.c
 hw/pci-host/pam.c
-hw/pci-host/versatile.c
 hw/pci/msi.c
 hw/pci/msix.c
 hw/pci/pci.c
@@ -338,34 +260,10 @@ hw/scsi/scsi-disk.c
 hw/scsi/scsi-generic.c
 hw/scsi/vmw_pvscsi.c
 hw/sd/core.c
-hw/sd/pl181.c
 hw/sd/sd.c
 hw/sd/sdhci.c
 hw/sd/sdmmc-internal.c
-hw/sd/ssi-sd.c
 hw/smbios/smbios.c
-hw/smbios/smbios_type_38-stub.c
-hw/ssi/aspeed_smc.c
-hw/ssi/mss-spi.c
-hw/ssi/pl022.c
-hw/ssi/ssi.c
-hw/ssi/stm32f2xx_spi.c
-hw/ssi/xilinx_spips.c
-hw/timer/a9gtimer.c
-hw/timer/arm_mptimer.c
-hw/timer/arm_timer.c
-hw/timer/armv7m_systick.c
-hw/timer/aspeed_timer.c
-hw/timer/cadence_ttc.c
-hw/timer/cmsdk-apb-timer.c
-hw/timer/ds1338.c
-hw/timer/imx_epit.c
-hw/timer/imx_gpt.c
-hw/timer/mss-timer.c
-hw/timer/pl031.c
-hw/timer/stm32f2xx_timer.c
-hw/timer/twl92230.c
-hw/timer/xlnx-zynqmp-rtc.c
 hw/tpm/tpm_emulator.c
 hw/tpm/tpm_util.c
 hw/usb/bus.c
@@ -385,9 +283,7 @@ hw/usb/dev-storage.c
 hw/usb/dev-uas.c
 hw/usb/dev-wacom.c
 hw/usb/hcd-ehci-pci.c
-hw/usb/hcd-ehci-sysbus.c
 hw/usb/hcd-ehci.c
-hw/usb/hcd-musb.c
 hw/usb/hcd-ohci.c
 hw/usb/hcd-uhci.c
 hw/usb/hcd-xhci-nec.c
@@ -400,7 +296,6 @@ hw/virtio/virtio-mmio.c
 hw/virtio/virtio-pci.c
 hw/virtio/virtio-rng.c
 hw/watchdog/watchdog.c
-hw/watchdog/wdt_aspeed.c
 hw/watchdog/wdt_i6300esb.c
 io/channel-buffer.c
 io/channel-command.c
@@ -920,10 +815,13 @@ arch_init.c
 balloon.c
 cpus.c
 disas.c
+disas/arm.c
 dump.c
 exec.c
 fpu/softfloat.c
 gdbstub.c
+hw/acpi/acpi-stub.c
+hw/acpi/ipmi-stub.c
 hw/adc/stm32f2xx_adc.c
 hw/arm/allwinner-a10.c
 hw/arm/armv7m.c
@@ -982,26 +880,50 @@ hw/arm/xilinx_zynq.c
 hw/arm/xlnx-zcu102.c
 hw/arm/xlnx-zynqmp.c
 hw/arm/z2.c
+hw/audio/lm4549.c
+hw/audio/marvell_88w8618.c
+hw/audio/pl041.c
+hw/audio/wm8750.c
 hw/block/dataplane/virtio-blk.c
+hw/block/ecc.c
+hw/block/m25p80.c
+hw/block/nand.c
+hw/block/onenand.c
+hw/block/pflash_cfi02.c
 hw/block/virtio-blk.c
 hw/char/bcm2835_aux.c
+hw/char/cadence_uart.c
+hw/char/cmsdk-apb-uart.c
 hw/char/digic-uart.c
 hw/char/exynos4210_uart.c
 hw/char/goldfish_tty.c
+hw/char/imx_serial.c
 hw/char/omap_uart.c
+hw/char/pl011.c
 hw/char/stm32f2xx_usart.c
 hw/char/virtio-serial-bus.c
 hw/core/generic-loader.c
 hw/core/null-machine.c
+hw/core/platform-bus.c
+hw/core/ptimer.c
+hw/core/stream.c
 hw/cpu/a15mpcore.c
 hw/cpu/a9mpcore.c
 hw/cpu/arm11mpcore.c
 hw/cpu/realview_mpcore.c
+hw/display/ads7846.c
 hw/display/bcm2835_fb.c
+hw/display/blizzard.c
 hw/display/dpcd.c
+hw/display/exynos4210_fimd.c
 hw/display/omap_dss.c
 hw/display/omap_lcdc.c
+hw/display/pl110.c
 hw/display/pxa2xx_lcd.c
+hw/display/sii9022.c
+hw/display/ssd0303.c
+hw/display/ssd0323.c
+hw/display/tc6393xb.c
 hw/display/vga.c
 hw/display/virtio-gpu-3d.c
 hw/display/virtio-gpu-pci.c
@@ -1009,20 +931,48 @@ hw/display/virtio-gpu.c
 hw/display/xlnx_dp.c
 hw/dma/bcm2835_dma.c
 hw/dma/omap_dma.c
+hw/dma/pl080.c
+hw/dma/pl330.c
 hw/dma/pxa2xx_dma.c
 hw/dma/soc_dma.c
+hw/dma/xilinx_axidma.c
+hw/dma/xlnx-zynq-devcfg.c
 hw/dma/xlnx_dpdma.c
 hw/gpio/bcm2835_gpio.c
+hw/gpio/gpio_key.c
 hw/gpio/imx_gpio.c
+hw/gpio/max7310.c
 hw/gpio/omap_gpio.c
+hw/gpio/pl061.c
+hw/gpio/zaurus.c
+hw/i2c/aspeed_i2c.c
+hw/i2c/bitbang_i2c.c
+hw/i2c/exynos4210_i2c.c
+hw/i2c/i2c-ddc.c
+hw/i2c/imx_i2c.c
 hw/i2c/omap_i2c.c
+hw/i2c/versatile_i2c.c
+hw/ide/ahci-allwinner.c
+hw/ide/microdrive.c
 hw/input/goldfish_events.c
 hw/input/goldfish_events_common.c
 hw/input/goldfish_rotary.c
+hw/input/lm832x.c
+hw/input/pl050.c
 hw/input/pxa2xx_keypad.c
+hw/input/stellaris_input.c
+hw/input/tsc2005.c
 hw/input/tsc210x.c
 hw/intc/allwinner-a10-pic.c
+hw/intc/arm_gic.c
+hw/intc/arm_gic_common.c
+hw/intc/arm_gicv2m.c
+hw/intc/arm_gicv3.c
+hw/intc/arm_gicv3_common.c
 hw/intc/arm_gicv3_cpuif.c
+hw/intc/arm_gicv3_dist.c
+hw/intc/arm_gicv3_its_common.c
+hw/intc/arm_gicv3_redist.c
 hw/intc/armv7m_nvic.c
 hw/intc/aspeed_vic.c
 hw/intc/bcm2835_ic.c
@@ -1030,7 +980,17 @@ hw/intc/bcm2836_control.c
 hw/intc/exynos4210_combiner.c
 hw/intc/exynos4210_gic.c
 hw/intc/goldfish_pic.c
+hw/intc/imx_avic.c
+hw/intc/imx_gpcv2.c
 hw/intc/omap_intc.c
+hw/intc/pl190.c
+hw/intc/realview_gic.c
+hw/intc/xlnx-pmu-iomod-intc.c
+hw/intc/xlnx-zynqmp-ipi.c
+hw/misc/a9scu.c
+hw/misc/arm11scu.c
+hw/misc/arm_integrator_debug.c
+hw/misc/arm_l2x0.c
 hw/misc/arm_sysctl.c
 hw/misc/aspeed_scu.c
 hw/misc/aspeed_sdmc.c
@@ -1056,6 +1016,7 @@ hw/misc/imx7_gpr.c
 hw/misc/imx7_snvs.c
 hw/misc/imx_ccm.c
 hw/misc/iotkit-secctl.c
+hw/misc/max111x.c
 hw/misc/mmio_interface.c
 hw/misc/mps2-fpgaio.c
 hw/misc/mps2-scc.c
@@ -1067,34 +1028,75 @@ hw/misc/omap_l4.c
 hw/misc/omap_sdrc.c
 hw/misc/omap_tap.c
 hw/misc/stm32f2xx_syscfg.c
+hw/misc/tmp105.c
+hw/misc/tmp421.c
 hw/misc/tz-ppc.c
 hw/misc/zynq-xadc.c
 hw/misc/zynq_slcr.c
+hw/net/allwinner_emac.c
+hw/net/cadence_gem.c
+hw/net/ftgmac100.c
+hw/net/imx_fec.c
+hw/net/lan9118.c
+hw/net/smc91c111.c
+hw/net/stellaris_enet.c
 hw/net/vhost_net.c
 hw/net/virtio-net.c
+hw/net/xgmac.c
+hw/net/xilinx_axienet.c
+hw/pci-host/designware.c
+hw/pci-host/gpex.c
+hw/pci-host/versatile.c
 hw/pcmcia/pxa2xx.c
 hw/scsi/virtio-scsi-dataplane.c
 hw/scsi/virtio-scsi.c
 hw/sd/bcm2835_sdhost.c
 hw/sd/omap_mmc.c
+hw/sd/pl181.c
 hw/sd/pxa2xx_mmci.c
+hw/sd/ssi-sd.c
+hw/smbios/smbios_type_38-stub.c
+hw/ssi/aspeed_smc.c
 hw/ssi/imx_spi.c
+hw/ssi/mss-spi.c
 hw/ssi/omap_spi.c
+hw/ssi/pl022.c
+hw/ssi/ssi.c
+hw/ssi/stm32f2xx_spi.c
+hw/ssi/xilinx_spips.c
+hw/timer/a9gtimer.c
 hw/timer/allwinner-a10-pit.c
+hw/timer/arm_mptimer.c
+hw/timer/arm_timer.c
+hw/timer/armv7m_systick.c
+hw/timer/aspeed_timer.c
+hw/timer/cadence_ttc.c
+hw/timer/cmsdk-apb-timer.c
 hw/timer/digic-timer.c
+hw/timer/ds1338.c
 hw/timer/exynos4210_mct.c
 hw/timer/exynos4210_pwm.c
 hw/timer/exynos4210_rtc.c
 hw/timer/goldfish_timer.c
+hw/timer/imx_epit.c
+hw/timer/imx_gpt.c
+hw/timer/mss-timer.c
 hw/timer/omap_gptimer.c
 hw/timer/omap_synctimer.c
+hw/timer/pl031.c
 hw/timer/pxa2xx_timer.c
+hw/timer/stm32f2xx_timer.c
+hw/timer/twl92230.c
+hw/timer/xlnx-zynqmp-rtc.c
 hw/usb/chipidea.c
+hw/usb/hcd-ehci-sysbus.c
+hw/usb/hcd-musb.c
 hw/usb/tusb6010.c
 hw/virtio/virtio-balloon.c
 hw/virtio/virtio-crypto-pci.c
 hw/virtio/virtio-crypto.c
 hw/virtio/virtio.c
+hw/watchdog/wdt_aspeed.c
 ioport.c
 memory.c
 memory_mapping.c
@@ -1134,6 +1136,348 @@ set(qemu-system-aarch64_generated_sources ""
 ${ANDROID_AUTOGEN}/trace/generated-helpers.c)
 set(qemu-system-aarch64_dep libqemuutil qemu2-shared)
 
+## TARGET: qemu-system-i386 ##
+set(qemu-system-i386_sources ""
+accel/accel.c
+accel/stubs/gvm-stub.c
+accel/stubs/hvf-stub.c
+accel/stubs/kvm-stub.c
+accel/stubs/whpx-stub.c
+accel/tcg/cpu-exec-common.c
+accel/tcg/cpu-exec.c
+accel/tcg/cputlb.c
+accel/tcg/tcg-all.c
+accel/tcg/tcg-runtime-gvec.c
+accel/tcg/tcg-runtime.c
+accel/tcg/translate-all.c
+accel/tcg/translator.c
+arch_init.c
+balloon.c
+cpus.c
+disas.c
+disas/i386.c
+dump.c
+exec.c
+fpu/softfloat.c
+gdbstub.c
+hw/acpi/core.c
+hw/acpi/cpu.c
+hw/acpi/cpu_hotplug.c
+hw/acpi/ich9.c
+hw/acpi/ipmi.c
+hw/acpi/memory_hotplug.c
+hw/acpi/nvdimm.c
+hw/acpi/pcihp.c
+hw/acpi/piix4.c
+hw/acpi/tco.c
+hw/acpi/vmgenid.c
+hw/audio/adlib.c
+hw/audio/cs4231a.c
+hw/audio/fmopl.c
+hw/audio/gus.c
+hw/audio/gusemu_hal.c
+hw/audio/gusemu_mixer.c
+hw/audio/pcspk.c
+hw/audio/sb16.c
+hw/block/dataplane/virtio-blk.c
+hw/block/fdc.c
+hw/block/virtio-blk.c
+hw/char/debugcon.c
+hw/char/goldfish_tty.c
+hw/char/parallel-isa.c
+hw/char/parallel.c
+hw/char/virtio-serial-bus.c
+hw/core/generic-loader.c
+hw/core/null-machine.c
+hw/display/cirrus_vga.c
+hw/display/vga-isa.c
+hw/display/vga.c
+hw/display/virtio-gpu-3d.c
+hw/display/virtio-gpu-pci.c
+hw/display/virtio-gpu.c
+hw/display/virtio-vga.c
+hw/display/vmware_vga.c
+hw/dma/i8257.c
+hw/i2c/pm_smbus.c
+hw/i2c/smbus_ich9.c
+hw/i386/amd_iommu.c
+hw/i386/intel_iommu.c
+hw/i386/kvmvapic.c
+hw/i386/multiboot.c
+hw/i386/pc.c
+hw/i386/pc_q35.c
+hw/i386/pc_sysfw.c
+hw/i386/vmmouse.c
+hw/i386/vmport.c
+hw/i386/x86-iommu.c
+hw/ide/isa.c
+hw/ide/piix.c
+hw/input/goldfish_events.c
+hw/input/goldfish_events_common.c
+hw/input/goldfish_rotary.c
+hw/input/pckbd.c
+hw/intc/apic.c
+hw/intc/apic_common.c
+hw/intc/goldfish_pic.c
+hw/intc/i8259.c
+hw/intc/i8259_common.c
+hw/intc/ioapic.c
+hw/intc/ioapic_common.c
+hw/ipmi/ipmi.c
+hw/ipmi/ipmi_bmc_extern.c
+hw/ipmi/ipmi_bmc_sim.c
+hw/ipmi/isa_ipmi_bt.c
+hw/ipmi/isa_ipmi_kcs.c
+hw/isa/apm.c
+hw/isa/lpc_ich9.c
+hw/mem/nvdimm.c
+hw/mem/pc-dimm.c
+hw/misc/applesmc.c
+hw/misc/debugexit.c
+hw/misc/goldfish_battery.c
+hw/misc/goldfish_pipe.c
+hw/misc/goldfish_pstore.c
+hw/misc/goldfish_sync.c
+hw/misc/mmio_interface.c
+hw/misc/pc-testdev.c
+hw/misc/pvpanic.c
+hw/misc/sga.c
+hw/net/ne2000-isa.c
+hw/net/vhost_net.c
+hw/net/virtio-net.c
+hw/net/vmxnet3.c
+hw/pci-bridge/pci_expander_bridge.c
+hw/pci-host/piix.c
+hw/pci-host/q35.c
+hw/scsi/virtio-scsi-dataplane.c
+hw/scsi/virtio-scsi.c
+hw/smbios/smbios_type_38.c
+hw/timer/goldfish_timer.c
+hw/timer/hpet.c
+hw/timer/i8254.c
+hw/timer/i8254_common.c
+hw/timer/mc146818rtc.c
+hw/tpm/tpm_crb.c
+hw/tpm/tpm_tis.c
+hw/virtio/virtio-balloon.c
+hw/virtio/virtio-crypto-pci.c
+hw/virtio/virtio-crypto.c
+hw/virtio/virtio.c
+hw/watchdog/wdt_ib700.c
+ioport.c
+memory.c
+memory_mapping.c
+migration/ram.c
+monitor.c
+numa.c
+qtest.c
+target/i386/arch_dump.c
+target/i386/arch_memory_mapping.c
+target/i386/bpt_helper.c
+target/i386/cc_helper.c
+target/i386/cpu.c
+target/i386/excp_helper.c
+target/i386/fpu_helper.c
+target/i386/gdbstub.c
+target/i386/hax-all.c
+target/i386/hax-darwin.c
+target/i386/hax-mem.c
+target/i386/helper.c
+target/i386/int_helper.c
+target/i386/kvm-stub.c
+target/i386/machine.c
+target/i386/mem_helper.c
+target/i386/misc_helper.c
+target/i386/monitor.c
+target/i386/mpx_helper.c
+target/i386/seg_helper.c
+target/i386/sev-stub.c
+target/i386/smm_helper.c
+target/i386/svm_helper.c
+target/i386/translate.c
+target/i386/xsave_helper.c
+tcg/optimize.c
+tcg/tcg-common.c
+tcg/tcg-op-gvec.c
+tcg/tcg-op-vec.c
+tcg/tcg-op.c
+tcg/tcg.c
+trace/control-target.c)
+set(qemu-system-i386_generated_sources ""
+${ANDROID_AUTOGEN}/trace/generated-helpers.c)
+set(qemu-system-i386_dep libqemuutil qemu2-shared)
+
+## TARGET: qemu-system-x86_64 ##
+set(qemu-system-x86_64_sources ""
+accel/accel.c
+accel/stubs/gvm-stub.c
+accel/stubs/hvf-stub.c
+accel/stubs/kvm-stub.c
+accel/stubs/whpx-stub.c
+accel/tcg/cpu-exec-common.c
+accel/tcg/cpu-exec.c
+accel/tcg/cputlb.c
+accel/tcg/tcg-all.c
+accel/tcg/tcg-runtime-gvec.c
+accel/tcg/tcg-runtime.c
+accel/tcg/translate-all.c
+accel/tcg/translator.c
+arch_init.c
+balloon.c
+cpus.c
+disas.c
+disas/i386.c
+dump.c
+exec.c
+fpu/softfloat.c
+gdbstub.c
+hw/acpi/core.c
+hw/acpi/cpu.c
+hw/acpi/cpu_hotplug.c
+hw/acpi/ich9.c
+hw/acpi/ipmi.c
+hw/acpi/memory_hotplug.c
+hw/acpi/nvdimm.c
+hw/acpi/pcihp.c
+hw/acpi/piix4.c
+hw/acpi/tco.c
+hw/acpi/vmgenid.c
+hw/audio/adlib.c
+hw/audio/cs4231a.c
+hw/audio/fmopl.c
+hw/audio/gus.c
+hw/audio/gusemu_hal.c
+hw/audio/gusemu_mixer.c
+hw/audio/pcspk.c
+hw/audio/sb16.c
+hw/block/dataplane/virtio-blk.c
+hw/block/fdc.c
+hw/block/virtio-blk.c
+hw/char/debugcon.c
+hw/char/goldfish_tty.c
+hw/char/parallel-isa.c
+hw/char/parallel.c
+hw/char/virtio-serial-bus.c
+hw/core/generic-loader.c
+hw/core/null-machine.c
+hw/display/cirrus_vga.c
+hw/display/vga-isa.c
+hw/display/vga.c
+hw/display/virtio-gpu-3d.c
+hw/display/virtio-gpu-pci.c
+hw/display/virtio-gpu.c
+hw/display/virtio-vga.c
+hw/display/vmware_vga.c
+hw/dma/i8257.c
+hw/i2c/pm_smbus.c
+hw/i2c/smbus_ich9.c
+hw/i386/amd_iommu.c
+hw/i386/intel_iommu.c
+hw/i386/kvmvapic.c
+hw/i386/multiboot.c
+hw/i386/pc.c
+hw/i386/pc_q35.c
+hw/i386/pc_sysfw.c
+hw/i386/vmmouse.c
+hw/i386/vmport.c
+hw/i386/x86-iommu.c
+hw/ide/isa.c
+hw/ide/piix.c
+hw/input/goldfish_events.c
+hw/input/goldfish_events_common.c
+hw/input/goldfish_rotary.c
+hw/input/pckbd.c
+hw/intc/apic.c
+hw/intc/apic_common.c
+hw/intc/goldfish_pic.c
+hw/intc/i8259.c
+hw/intc/i8259_common.c
+hw/intc/ioapic.c
+hw/intc/ioapic_common.c
+hw/ipmi/ipmi.c
+hw/ipmi/ipmi_bmc_extern.c
+hw/ipmi/ipmi_bmc_sim.c
+hw/ipmi/isa_ipmi_bt.c
+hw/ipmi/isa_ipmi_kcs.c
+hw/isa/apm.c
+hw/isa/lpc_ich9.c
+hw/mem/nvdimm.c
+hw/mem/pc-dimm.c
+hw/misc/applesmc.c
+hw/misc/debugexit.c
+hw/misc/goldfish_battery.c
+hw/misc/goldfish_pipe.c
+hw/misc/goldfish_pstore.c
+hw/misc/goldfish_sync.c
+hw/misc/mmio_interface.c
+hw/misc/pc-testdev.c
+hw/misc/pvpanic.c
+hw/misc/sga.c
+hw/net/ne2000-isa.c
+hw/net/vhost_net.c
+hw/net/virtio-net.c
+hw/net/vmxnet3.c
+hw/pci-bridge/pci_expander_bridge.c
+hw/pci-host/piix.c
+hw/pci-host/q35.c
+hw/scsi/virtio-scsi-dataplane.c
+hw/scsi/virtio-scsi.c
+hw/smbios/smbios_type_38.c
+hw/timer/goldfish_timer.c
+hw/timer/hpet.c
+hw/timer/i8254.c
+hw/timer/i8254_common.c
+hw/timer/mc146818rtc.c
+hw/tpm/tpm_crb.c
+hw/tpm/tpm_tis.c
+hw/virtio/virtio-balloon.c
+hw/virtio/virtio-crypto-pci.c
+hw/virtio/virtio-crypto.c
+hw/virtio/virtio.c
+hw/watchdog/wdt_ib700.c
+ioport.c
+memory.c
+memory_mapping.c
+migration/ram.c
+monitor.c
+numa.c
+qtest.c
+target/i386/arch_dump.c
+target/i386/arch_memory_mapping.c
+target/i386/bpt_helper.c
+target/i386/cc_helper.c
+target/i386/cpu.c
+target/i386/excp_helper.c
+target/i386/fpu_helper.c
+target/i386/gdbstub.c
+target/i386/hax-all.c
+target/i386/hax-darwin.c
+target/i386/hax-mem.c
+target/i386/helper.c
+target/i386/int_helper.c
+target/i386/kvm-stub.c
+target/i386/machine.c
+target/i386/mem_helper.c
+target/i386/misc_helper.c
+target/i386/monitor.c
+target/i386/mpx_helper.c
+target/i386/seg_helper.c
+target/i386/sev-stub.c
+target/i386/smm_helper.c
+target/i386/svm_helper.c
+target/i386/translate.c
+target/i386/xsave_helper.c
+tcg/optimize.c
+tcg/tcg-common.c
+tcg/tcg-op-gvec.c
+tcg/tcg-op-vec.c
+tcg/tcg-op.c
+tcg/tcg.c
+trace/control-target.c)
+set(qemu-system-x86_64_generated_sources ""
+${ANDROID_AUTOGEN}/trace/generated-helpers.c)
+set(qemu-system-x86_64_dep libqemuutil qemu2-shared)
+
 set_source_files_properties(${ANDROID_AUTOGEN}/accel/kvm/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/accel/kvm")
 
 set_source_files_properties(${ANDROID_AUTOGEN}/hw/9pfs/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/9pfs")
@@ -1142,12 +1486,8 @@ set_source_files_properties(${ANDROID_AUTOGEN}/hw/alpha/trace.c PROPERTIES COMPI
 
 set_source_files_properties(${ANDROID_AUTOGEN}/hw/hppa/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/hppa")
 
-set_source_files_properties(${ANDROID_AUTOGEN}/hw/i386/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/i386")
-
 set_source_files_properties(${ANDROID_AUTOGEN}/hw/i386/xen/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/i386/xen")
 
-set_source_files_properties(${ANDROID_AUTOGEN}/hw/mem/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/mem")
-
 set_source_files_properties(${ANDROID_AUTOGEN}/hw/misc/macio/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/misc/macio")
 
 set_source_files_properties(${ANDROID_AUTOGEN}/hw/ppc/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/ppc")
@@ -1168,8 +1508,6 @@ set_source_files_properties(${ANDROID_AUTOGEN}/hw/xen/trace.c PROPERTIES COMPILE
 
 set_source_files_properties(${ANDROID_AUTOGEN}/linux-user/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/linux-user")
 
-set_source_files_properties(${ANDROID_AUTOGEN}/target/i386/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/target/i386")
-
 set_source_files_properties(${ANDROID_AUTOGEN}/target/mips/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/target/mips")
 
 set_source_files_properties(${ANDROID_AUTOGEN}/target/ppc/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/target/ppc")
@@ -1181,7 +1519,7 @@ set_source_files_properties(${ANDROID_AUTOGEN}/target/sparc/trace.c PROPERTIES C
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/accel/accel.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/accel")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/accel/stubs/gvm-stub.c ${ANDROID_QEMU2_TOP_DIR}/accel/stubs/kvm-stub.c ${ANDROID_QEMU2_TOP_DIR}/accel/stubs/whpx-stub.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/accel/stubs/gvm-stub.c ${ANDROID_QEMU2_TOP_DIR}/accel/stubs/hvf-stub.c ${ANDROID_QEMU2_TOP_DIR}/accel/stubs/kvm-stub.c ${ANDROID_QEMU2_TOP_DIR}/accel/stubs/whpx-stub.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/accel/stubs")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/accel/tcg/cpu-exec-common.c ${ANDROID_QEMU2_TOP_DIR}/accel/tcg/cpu-exec.c ${ANDROID_QEMU2_TOP_DIR}/accel/tcg/cputlb.c ${ANDROID_QEMU2_TOP_DIR}/accel/tcg/tcg-all.c ${ANDROID_QEMU2_TOP_DIR}/accel/tcg/tcg-runtime-gvec.c ${ANDROID_QEMU2_TOP_DIR}/accel/tcg/tcg-runtime.c ${ANDROID_QEMU2_TOP_DIR}/accel/tcg/translate-all.c ${ANDROID_QEMU2_TOP_DIR}/accel/tcg/translator.c
@@ -1205,7 +1543,7 @@ ${ANDROID_AUTOGEN}/chardev/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOG
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/crypto/aes.c ${ANDROID_QEMU2_TOP_DIR}/crypto/afsplit.c ${ANDROID_QEMU2_TOP_DIR}/crypto/block-luks.c ${ANDROID_QEMU2_TOP_DIR}/crypto/block-qcow.c ${ANDROID_QEMU2_TOP_DIR}/crypto/block.c ${ANDROID_QEMU2_TOP_DIR}/crypto/cipher.c ${ANDROID_QEMU2_TOP_DIR}/crypto/desrfb.c ${ANDROID_QEMU2_TOP_DIR}/crypto/hash-glib.c ${ANDROID_QEMU2_TOP_DIR}/crypto/hash.c ${ANDROID_QEMU2_TOP_DIR}/crypto/hmac-glib.c ${ANDROID_QEMU2_TOP_DIR}/crypto/hmac.c ${ANDROID_QEMU2_TOP_DIR}/crypto/init.c ${ANDROID_QEMU2_TOP_DIR}/crypto/ivgen-essiv.c ${ANDROID_QEMU2_TOP_DIR}/crypto/ivgen-plain.c ${ANDROID_QEMU2_TOP_DIR}/crypto/ivgen-plain64.c ${ANDROID_QEMU2_TOP_DIR}/crypto/ivgen.c ${ANDROID_QEMU2_TOP_DIR}/crypto/pbkdf-stub.c ${ANDROID_QEMU2_TOP_DIR}/crypto/pbkdf.c ${ANDROID_QEMU2_TOP_DIR}/crypto/random-platform.c ${ANDROID_QEMU2_TOP_DIR}/crypto/secret.c ${ANDROID_QEMU2_TOP_DIR}/crypto/tlscreds.c ${ANDROID_QEMU2_TOP_DIR}/crypto/tlscredsanon.c ${ANDROID_QEMU2_TOP_DIR}/crypto/tlscredsx509.c ${ANDROID_QEMU2_TOP_DIR}/crypto/tlssession.c ${ANDROID_QEMU2_TOP_DIR}/crypto/xts.c
 ${ANDROID_AUTOGEN}/crypto/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/crypto")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/disas/arm-a64.cc ${ANDROID_QEMU2_TOP_DIR}/disas/arm.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/disas/arm-a64.cc ${ANDROID_QEMU2_TOP_DIR}/disas/arm.c ${ANDROID_QEMU2_TOP_DIR}/disas/i386.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/disas")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/disas/libvixl/vixl/a64/decoder-a64.cc ${ANDROID_QEMU2_TOP_DIR}/disas/libvixl/vixl/a64/disasm-a64.cc ${ANDROID_QEMU2_TOP_DIR}/disas/libvixl/vixl/a64/instructions-a64.cc
@@ -1217,7 +1555,7 @@ PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/disas/libvixl/vixl")
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/fpu/softfloat.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/fpu")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/acpi/acpi-stub.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/acpi_interface.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/aml-build.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/bios-linker-loader.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/ipmi-stub.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/acpi/acpi-stub.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/acpi_interface.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/aml-build.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/bios-linker-loader.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/cpu.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/cpu_hotplug.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/ich9.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/ipmi-stub.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/ipmi.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/memory_hotplug.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/nvdimm.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/pcihp.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/piix4.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/tco.c ${ANDROID_QEMU2_TOP_DIR}/hw/acpi/vmgenid.c
 ${ANDROID_AUTOGEN}/hw/acpi/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/acpi")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/adc/stm32f2xx_adc.c
@@ -1226,10 +1564,10 @@ PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/adc")
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/arm/allwinner-a10.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/armv7m.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/aspeed.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/aspeed_soc.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/bcm2835_peripherals.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/bcm2836.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/boot.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/collie.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/cubieboard.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/digic.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/digic_boards.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/exynos4210.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/exynos4_boards.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/fsl-imx25.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/fsl-imx31.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/fsl-imx6.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/fsl-imx7.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/gumstix.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/highbank.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/imx25_pdk.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/integratorcp.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/iotkit.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/kzm.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/mainstone.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/mcimx7d-sabre.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/mps2-tz.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/mps2.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/msf2-soc.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/msf2-som.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/musicpal.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/netduino2.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/nseries.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/omap1.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/omap2.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/omap_sx1.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/palm.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/pxa2xx.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/pxa2xx_gpio.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/pxa2xx_pic.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/ranchu.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/raspi.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/realview.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/sabrelite.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/spitz.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/stellaris.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/stm32f205_soc.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/strongarm.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/sysbus-fdt.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/tosa.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/versatilepb.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/vexpress.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/virt-acpi-build.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/virt.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/xilinx_zynq.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/xlnx-zcu102.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/xlnx-zynqmp.c ${ANDROID_QEMU2_TOP_DIR}/hw/arm/z2.c
 ${ANDROID_AUTOGEN}/hw/arm/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/arm")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/audio/ac97.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/es1370.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/goldfish_audio.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/hda-codec.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/intel-hda.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/lm4549.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/marvell_88w8618.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/pl041.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/soundhw.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/wm8750.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/audio/ac97.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/adlib.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/cs4231a.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/es1370.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/fmopl.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/goldfish_audio.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/gus.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/gusemu_hal.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/gusemu_mixer.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/hda-codec.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/intel-hda.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/lm4549.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/marvell_88w8618.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/pcspk.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/pl041.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/sb16.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/soundhw.c ${ANDROID_QEMU2_TOP_DIR}/hw/audio/wm8750.c
 ${ANDROID_AUTOGEN}/hw/audio/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/audio")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/block/block.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/cdrom.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/ecc.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/hd-geometry.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/m25p80.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/nand.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/nvme.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/onenand.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/pflash_cfi01.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/pflash_cfi02.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/virtio-blk.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/block/block.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/cdrom.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/ecc.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/fdc.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/hd-geometry.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/m25p80.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/nand.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/nvme.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/onenand.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/pflash_cfi01.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/pflash_cfi02.c ${ANDROID_QEMU2_TOP_DIR}/hw/block/virtio-blk.c
 ${ANDROID_AUTOGEN}/hw/block/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/block")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/block/dataplane/virtio-blk.c
@@ -1238,7 +1576,7 @@ ${ANDROID_AUTOGEN}/hw/block/dataplane/trace.c PROPERTIES COMPILE_FLAGS " -I ${AN
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/bt/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/bt/hci-csr.c ${ANDROID_QEMU2_TOP_DIR}/hw/bt/hci.c ${ANDROID_QEMU2_TOP_DIR}/hw/bt/hid.c ${ANDROID_QEMU2_TOP_DIR}/hw/bt/l2cap.c ${ANDROID_QEMU2_TOP_DIR}/hw/bt/sdp.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/bt")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/char/bcm2835_aux.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/cadence_uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/cmsdk-apb-uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/digic-uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/exynos4210_uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/goldfish_tty.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/imx_serial.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/ipoctal232.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/omap_uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/pl011.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/serial-isa.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/serial-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/serial.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/stm32f2xx_usart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/virtio-console.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/virtio-serial-bus.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/char/bcm2835_aux.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/cadence_uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/cmsdk-apb-uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/debugcon.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/digic-uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/exynos4210_uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/goldfish_tty.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/imx_serial.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/ipoctal232.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/omap_uart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/parallel-isa.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/parallel.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/pl011.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/serial-isa.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/serial-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/serial.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/stm32f2xx_usart.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/virtio-console.c ${ANDROID_QEMU2_TOP_DIR}/hw/char/virtio-serial-bus.c
 ${ANDROID_AUTOGEN}/hw/char/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/char")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/core/bus.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/fw-path-provider.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/generic-loader.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/hotplug.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/irq.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/loader.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/machine.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/nmi.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/null-machine.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/or-irq.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/platform-bus.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/ptimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/qdev-fw.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/qdev-properties-system.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/qdev-properties.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/qdev.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/register.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/reset.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/split-irq.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/stream.c ${ANDROID_QEMU2_TOP_DIR}/hw/core/sysbus.c
@@ -1247,37 +1585,46 @@ PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/core")
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/cpu/a15mpcore.c ${ANDROID_QEMU2_TOP_DIR}/hw/cpu/a9mpcore.c ${ANDROID_QEMU2_TOP_DIR}/hw/cpu/arm11mpcore.c ${ANDROID_QEMU2_TOP_DIR}/hw/cpu/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/cpu/realview_mpcore.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/cpu")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/display/ads7846.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/bcm2835_fb.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/blizzard.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/dpcd.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/edid-generate.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/exynos4210_fimd.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/framebuffer.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/goldfish_fb.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/omap_dss.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/omap_lcdc.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/pl110.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/pxa2xx_lcd.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/sii9022.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/ssd0303.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/ssd0323.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/tc6393xb.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/vga-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/vga.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/virtio-gpu-3d.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/virtio-gpu-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/virtio-gpu.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/xlnx_dp.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/display/ads7846.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/bcm2835_fb.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/blizzard.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/cirrus_vga.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/dpcd.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/edid-generate.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/exynos4210_fimd.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/framebuffer.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/goldfish_fb.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/omap_dss.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/omap_lcdc.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/pl110.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/pxa2xx_lcd.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/sii9022.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/ssd0303.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/ssd0323.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/tc6393xb.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/vga-isa.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/vga-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/vga.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/virtio-gpu-3d.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/virtio-gpu-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/virtio-gpu.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/virtio-vga.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/vmware_vga.c ${ANDROID_QEMU2_TOP_DIR}/hw/display/xlnx_dp.c
 ${ANDROID_AUTOGEN}/hw/display/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/display")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/dma/bcm2835_dma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/omap_dma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/pl080.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/pl330.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/pxa2xx_dma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/soc_dma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/xilinx_axidma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/xlnx-zynq-devcfg.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/xlnx_dpdma.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/dma/bcm2835_dma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/i8257.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/omap_dma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/pl080.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/pl330.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/pxa2xx_dma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/soc_dma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/xilinx_axidma.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/xlnx-zynq-devcfg.c ${ANDROID_QEMU2_TOP_DIR}/hw/dma/xlnx_dpdma.c
 ${ANDROID_AUTOGEN}/hw/dma/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/dma")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/gpio/bcm2835_gpio.c ${ANDROID_QEMU2_TOP_DIR}/hw/gpio/gpio_key.c ${ANDROID_QEMU2_TOP_DIR}/hw/gpio/imx_gpio.c ${ANDROID_QEMU2_TOP_DIR}/hw/gpio/max7310.c ${ANDROID_QEMU2_TOP_DIR}/hw/gpio/omap_gpio.c ${ANDROID_QEMU2_TOP_DIR}/hw/gpio/pl061.c ${ANDROID_QEMU2_TOP_DIR}/hw/gpio/zaurus.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/gpio")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/i2c/aspeed_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/bitbang_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/exynos4210_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/i2c-ddc.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/imx_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/omap_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/smbus.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/smbus_eeprom.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/versatile_i2c.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/i2c/aspeed_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/bitbang_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/exynos4210_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/i2c-ddc.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/imx_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/omap_i2c.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/pm_smbus.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/smbus.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/smbus_eeprom.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/smbus_ich9.c ${ANDROID_QEMU2_TOP_DIR}/hw/i2c/versatile_i2c.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/i2c")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/ide/ahci-allwinner.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/ahci.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/atapi.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/ich.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/microdrive.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/qdev.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/i386/amd_iommu.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/intel_iommu.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/kvmvapic.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/multiboot.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/pc.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/pc_q35.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/pc_sysfw.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/vmmouse.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/vmport.c ${ANDROID_QEMU2_TOP_DIR}/hw/i386/x86-iommu.c
+${ANDROID_AUTOGEN}/hw/i386/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/i386")
+
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/ide/ahci-allwinner.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/ahci.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/atapi.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/ich.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/isa.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/microdrive.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/piix.c ${ANDROID_QEMU2_TOP_DIR}/hw/ide/qdev.c
 ${ANDROID_AUTOGEN}/hw/ide/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/ide")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/input/goldfish_events.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/goldfish_events_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/goldfish_rotary.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/hid.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/lm832x.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/pl050.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/ps2.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/pxa2xx_keypad.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/stellaris_input.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/tsc2005.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/tsc210x.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/virtio-input-hid.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/virtio-input.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/input/goldfish_events.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/goldfish_events_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/goldfish_rotary.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/hid.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/lm832x.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/pckbd.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/pl050.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/ps2.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/pxa2xx_keypad.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/stellaris_input.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/tsc2005.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/tsc210x.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/virtio-input-hid.c ${ANDROID_QEMU2_TOP_DIR}/hw/input/virtio-input.c
 ${ANDROID_AUTOGEN}/hw/input/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/input")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/intc/allwinner-a10-pic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gic_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv2m.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_cpuif.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_dist.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_its_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_redist.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/armv7m_nvic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/aspeed_vic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/bcm2835_ic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/bcm2836_control.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/exynos4210_combiner.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/exynos4210_gic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/goldfish_pic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/imx_avic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/imx_gpcv2.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/intc.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/omap_intc.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/pl190.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/realview_gic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/xlnx-pmu-iomod-intc.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/xlnx-zynqmp-ipi.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/intc/allwinner-a10-pic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/apic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/apic_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gic_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv2m.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_cpuif.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_dist.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_its_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/arm_gicv3_redist.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/armv7m_nvic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/aspeed_vic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/bcm2835_ic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/bcm2836_control.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/exynos4210_combiner.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/exynos4210_gic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/goldfish_pic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/i8259.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/i8259_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/imx_avic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/imx_gpcv2.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/intc.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/ioapic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/ioapic_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/omap_intc.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/pl190.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/realview_gic.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/xlnx-pmu-iomod-intc.c ${ANDROID_QEMU2_TOP_DIR}/hw/intc/xlnx-zynqmp-ipi.c
 ${ANDROID_AUTOGEN}/hw/intc/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/intc")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/ipack/ipack.c ${ANDROID_QEMU2_TOP_DIR}/hw/ipack/tpci200.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/ipack")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/isa/isa-bus.c ${ANDROID_QEMU2_TOP_DIR}/hw/isa/isa-superio.c ${ANDROID_QEMU2_TOP_DIR}/hw/isa/smc37c669-superio.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/ipmi/ipmi.c ${ANDROID_QEMU2_TOP_DIR}/hw/ipmi/ipmi_bmc_extern.c ${ANDROID_QEMU2_TOP_DIR}/hw/ipmi/ipmi_bmc_sim.c ${ANDROID_QEMU2_TOP_DIR}/hw/ipmi/isa_ipmi_bt.c ${ANDROID_QEMU2_TOP_DIR}/hw/ipmi/isa_ipmi_kcs.c
+PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/ipmi")
+
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/isa/apm.c ${ANDROID_QEMU2_TOP_DIR}/hw/isa/isa-bus.c ${ANDROID_QEMU2_TOP_DIR}/hw/isa/isa-superio.c ${ANDROID_QEMU2_TOP_DIR}/hw/isa/lpc_ich9.c ${ANDROID_QEMU2_TOP_DIR}/hw/isa/smc37c669-superio.c
 ${ANDROID_AUTOGEN}/hw/isa/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/isa")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/misc/a9scu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/arm11scu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/arm_integrator_debug.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/arm_l2x0.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/arm_sysctl.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/aspeed_scu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/aspeed_sdmc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/auxbus.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/bcm2835_mbox.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/bcm2835_property.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/bcm2835_rng.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/cbus.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/edu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/exynos4210_clk.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/exynos4210_pmu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/exynos4210_rng.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/goldfish_battery.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/goldfish_pipe.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/goldfish_pstore.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/goldfish_sync.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx25_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx2_wdt.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx31_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx6_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx6_src.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx7_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx7_gpr.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx7_snvs.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/iotkit-secctl.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/max111x.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/mmio_interface.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/mps2-fpgaio.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/mps2-scc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/msf2-sysreg.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/mst_fpga.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_clk.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_gpmc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_l4.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_sdrc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_tap.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/pci-testdev.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/stm32f2xx_syscfg.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/tmp105.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/tmp421.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/tz-ppc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/unimp.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/vmcoreinfo.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/zynq-xadc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/zynq_slcr.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/mem/nvdimm.c ${ANDROID_QEMU2_TOP_DIR}/hw/mem/pc-dimm.c
+${ANDROID_AUTOGEN}/hw/mem/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/mem")
+
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/misc/a9scu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/applesmc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/arm11scu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/arm_integrator_debug.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/arm_l2x0.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/arm_sysctl.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/aspeed_scu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/aspeed_sdmc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/auxbus.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/bcm2835_mbox.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/bcm2835_property.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/bcm2835_rng.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/cbus.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/debugexit.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/edu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/exynos4210_clk.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/exynos4210_pmu.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/exynos4210_rng.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/goldfish_battery.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/goldfish_pipe.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/goldfish_pstore.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/goldfish_sync.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx25_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx2_wdt.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx31_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx6_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx6_src.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx7_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx7_gpr.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx7_snvs.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/imx_ccm.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/iotkit-secctl.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/max111x.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/mmio_interface.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/mps2-fpgaio.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/mps2-scc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/msf2-sysreg.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/mst_fpga.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_clk.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_gpmc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_l4.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_sdrc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/omap_tap.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/pc-testdev.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/pci-testdev.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/pvpanic.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/sga.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/stm32f2xx_syscfg.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/tmp105.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/tmp421.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/tz-ppc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/unimp.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/vmcoreinfo.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/zynq-xadc.c ${ANDROID_QEMU2_TOP_DIR}/hw/misc/zynq_slcr.c
 ${ANDROID_AUTOGEN}/hw/misc/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/misc")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/net/allwinner_emac.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/cadence_gem.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/eepro100.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/ftgmac100.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/imx_fec.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/lan9118.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/ne2000.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/net_rx_pkt.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/net_tx_pkt.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/pcnet-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/pcnet.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/rtl8139.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/smc91c111.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/stellaris_enet.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/vhost_net.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/virtio-net.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/xgmac.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/xilinx_axienet.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/net/allwinner_emac.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/cadence_gem.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/eepro100.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/ftgmac100.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/imx_fec.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/lan9118.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/ne2000-isa.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/ne2000.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/net_rx_pkt.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/net_tx_pkt.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/pcnet-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/pcnet.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/rtl8139.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/smc91c111.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/stellaris_enet.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/vhost_net.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/virtio-net.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/vmxnet3.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/xgmac.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/xilinx_axienet.c
 ${ANDROID_AUTOGEN}/hw/net/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/net")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/net/can/can_kvaser_pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/can/can_mioe3680_pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/can/can_pcm3680_pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/net/can/can_sja1000.c
@@ -1289,10 +1636,10 @@ PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/net/rocker")
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/nvram/chrp_nvram.c ${ANDROID_QEMU2_TOP_DIR}/hw/nvram/eeprom93xx.c ${ANDROID_QEMU2_TOP_DIR}/hw/nvram/eeprom_at24c.c ${ANDROID_QEMU2_TOP_DIR}/hw/nvram/fw_cfg.c
 ${ANDROID_AUTOGEN}/hw/nvram/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/nvram")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/gen_pcie_root_port.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/i82801b11.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/ioh3420.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/pci_bridge_dev.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/pcie_pci_bridge.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/pcie_root_port.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/xio3130_downstream.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/xio3130_upstream.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/gen_pcie_root_port.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/i82801b11.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/ioh3420.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/pci_bridge_dev.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/pci_expander_bridge.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/pcie_pci_bridge.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/pcie_root_port.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/xio3130_downstream.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-bridge/xio3130_upstream.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/pci-bridge")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/designware.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/gpex.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/pam.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/versatile.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/designware.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/gpex.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/pam.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/piix.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/q35.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci-host/versatile.c
 ${ANDROID_AUTOGEN}/hw/pci-host/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/pci-host")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/pci/msi.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/msix.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/pci_bridge.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/pci_host.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/pcie.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/pcie_aer.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/pcie_host.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/pcie_port.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/shpc.c ${ANDROID_QEMU2_TOP_DIR}/hw/pci/slotid_cap.c
@@ -1307,16 +1654,16 @@ ${ANDROID_AUTOGEN}/hw/scsi/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOG
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/sd/bcm2835_sdhost.c ${ANDROID_QEMU2_TOP_DIR}/hw/sd/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/sd/omap_mmc.c ${ANDROID_QEMU2_TOP_DIR}/hw/sd/pl181.c ${ANDROID_QEMU2_TOP_DIR}/hw/sd/pxa2xx_mmci.c ${ANDROID_QEMU2_TOP_DIR}/hw/sd/sd.c ${ANDROID_QEMU2_TOP_DIR}/hw/sd/sdhci.c ${ANDROID_QEMU2_TOP_DIR}/hw/sd/sdmmc-internal.c ${ANDROID_QEMU2_TOP_DIR}/hw/sd/ssi-sd.c
 ${ANDROID_AUTOGEN}/hw/sd/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/sd")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/smbios/smbios.c ${ANDROID_QEMU2_TOP_DIR}/hw/smbios/smbios_type_38-stub.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/smbios/smbios.c ${ANDROID_QEMU2_TOP_DIR}/hw/smbios/smbios_type_38-stub.c ${ANDROID_QEMU2_TOP_DIR}/hw/smbios/smbios_type_38.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/smbios")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/ssi/aspeed_smc.c ${ANDROID_QEMU2_TOP_DIR}/hw/ssi/imx_spi.c ${ANDROID_QEMU2_TOP_DIR}/hw/ssi/mss-spi.c ${ANDROID_QEMU2_TOP_DIR}/hw/ssi/omap_spi.c ${ANDROID_QEMU2_TOP_DIR}/hw/ssi/pl022.c ${ANDROID_QEMU2_TOP_DIR}/hw/ssi/ssi.c ${ANDROID_QEMU2_TOP_DIR}/hw/ssi/stm32f2xx_spi.c ${ANDROID_QEMU2_TOP_DIR}/hw/ssi/xilinx_spips.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/ssi")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/timer/a9gtimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/allwinner-a10-pit.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/arm_mptimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/arm_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/armv7m_systick.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/aspeed_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/cadence_ttc.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/cmsdk-apb-timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/digic-timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/ds1338.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/exynos4210_mct.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/exynos4210_pwm.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/exynos4210_rtc.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/goldfish_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/imx_epit.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/imx_gpt.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/mss-timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/omap_gptimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/omap_synctimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/pl031.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/pxa2xx_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/stm32f2xx_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/twl92230.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/xlnx-zynqmp-rtc.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/timer/a9gtimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/allwinner-a10-pit.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/arm_mptimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/arm_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/armv7m_systick.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/aspeed_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/cadence_ttc.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/cmsdk-apb-timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/digic-timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/ds1338.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/exynos4210_mct.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/exynos4210_pwm.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/exynos4210_rtc.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/goldfish_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/hpet.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/i8254.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/i8254_common.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/imx_epit.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/imx_gpt.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/mc146818rtc.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/mss-timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/omap_gptimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/omap_synctimer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/pl031.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/pxa2xx_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/stm32f2xx_timer.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/twl92230.c ${ANDROID_QEMU2_TOP_DIR}/hw/timer/xlnx-zynqmp-rtc.c
 ${ANDROID_AUTOGEN}/hw/timer/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/timer")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/tpm/tpm_emulator.c ${ANDROID_QEMU2_TOP_DIR}/hw/tpm/tpm_util.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/tpm/tpm_crb.c ${ANDROID_QEMU2_TOP_DIR}/hw/tpm/tpm_emulator.c ${ANDROID_QEMU2_TOP_DIR}/hw/tpm/tpm_tis.c ${ANDROID_QEMU2_TOP_DIR}/hw/tpm/tpm_util.c
 ${ANDROID_AUTOGEN}/hw/tpm/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/tpm")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/usb/bus.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/chipidea.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/combined-packet.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/core.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/desc-msos.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/desc.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-audio.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-bluetooth.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-hid.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-hub.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-mtp.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-network.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-serial.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-smartcard-reader.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-storage.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-uas.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/dev-wacom.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/hcd-ehci-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/hcd-ehci-sysbus.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/hcd-ehci.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/hcd-musb.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/hcd-ohci.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/hcd-uhci.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/hcd-xhci-nec.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/hcd-xhci.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/host-stub.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/libhw.c ${ANDROID_QEMU2_TOP_DIR}/hw/usb/tusb6010.c
@@ -1325,7 +1672,7 @@ ${ANDROID_AUTOGEN}/hw/usb/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGE
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/virtio/vhost-stub.c ${ANDROID_QEMU2_TOP_DIR}/hw/virtio/virtio-balloon.c ${ANDROID_QEMU2_TOP_DIR}/hw/virtio/virtio-bus.c ${ANDROID_QEMU2_TOP_DIR}/hw/virtio/virtio-crypto-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/virtio/virtio-crypto.c ${ANDROID_QEMU2_TOP_DIR}/hw/virtio/virtio-mmio.c ${ANDROID_QEMU2_TOP_DIR}/hw/virtio/virtio-pci.c ${ANDROID_QEMU2_TOP_DIR}/hw/virtio/virtio-rng.c ${ANDROID_QEMU2_TOP_DIR}/hw/virtio/virtio.c
 ${ANDROID_AUTOGEN}/hw/virtio/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/virtio")
 
-set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/watchdog/watchdog.c ${ANDROID_QEMU2_TOP_DIR}/hw/watchdog/wdt_aspeed.c ${ANDROID_QEMU2_TOP_DIR}/hw/watchdog/wdt_i6300esb.c
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/hw/watchdog/watchdog.c ${ANDROID_QEMU2_TOP_DIR}/hw/watchdog/wdt_aspeed.c ${ANDROID_QEMU2_TOP_DIR}/hw/watchdog/wdt_i6300esb.c ${ANDROID_QEMU2_TOP_DIR}/hw/watchdog/wdt_ib700.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/hw/watchdog")
 
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/io/channel-buffer.c ${ANDROID_QEMU2_TOP_DIR}/io/channel-command.c ${ANDROID_QEMU2_TOP_DIR}/io/channel-file.c ${ANDROID_QEMU2_TOP_DIR}/io/channel-socket.c ${ANDROID_QEMU2_TOP_DIR}/io/channel-tls.c ${ANDROID_QEMU2_TOP_DIR}/io/channel-util.c ${ANDROID_QEMU2_TOP_DIR}/io/channel-watch.c ${ANDROID_QEMU2_TOP_DIR}/io/channel-websock.c ${ANDROID_QEMU2_TOP_DIR}/io/channel.c ${ANDROID_QEMU2_TOP_DIR}/io/dns-resolver.c ${ANDROID_QEMU2_TOP_DIR}/io/net-listener.c ${ANDROID_QEMU2_TOP_DIR}/io/task.c
@@ -1367,6 +1714,9 @@ PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/stubs")
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/target/arm/arch_dump.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/arm-powerctl.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/arm-semi.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/cpu.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/cpu64.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/crypto_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/gdbstub.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/gdbstub64.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/helper-a64.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/helper.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/hvf.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/iwmmxt_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/kvm-stub.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/machine.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/monitor.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/neon_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/op_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/psci.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/translate-a64.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/translate.c ${ANDROID_QEMU2_TOP_DIR}/target/arm/vec_helper.c
 ${ANDROID_AUTOGEN}/target/arm/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/target/arm")
 
+set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/target/i386/arch_dump.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/arch_memory_mapping.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/bpt_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/cc_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/cpu.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/excp_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/fpu_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/gdbstub.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/hax-all.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/hax-darwin.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/hax-mem.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/int_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/kvm-stub.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/machine.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/mem_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/misc_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/monitor.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/mpx_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/seg_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/sev-stub.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/smm_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/svm_helper.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/translate.c ${ANDROID_QEMU2_TOP_DIR}/target/i386/xsave_helper.c
+${ANDROID_AUTOGEN}/target/i386/trace.c PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/target/i386")
+
 set_source_files_properties(${ANDROID_QEMU2_TOP_DIR}/tcg/optimize.c ${ANDROID_QEMU2_TOP_DIR}/tcg/tcg-common.c ${ANDROID_QEMU2_TOP_DIR}/tcg/tcg-op-gvec.c ${ANDROID_QEMU2_TOP_DIR}/tcg/tcg-op-vec.c ${ANDROID_QEMU2_TOP_DIR}/tcg/tcg-op.c ${ANDROID_QEMU2_TOP_DIR}/tcg/tcg.c
 PROPERTIES COMPILE_FLAGS " -I ${ANDROID_AUTOGEN}/tcg")
 
diff --git a/qt5-entitlements.xml b/qt5-entitlements.xml
new file mode 100644
index 0000000000..9ed7cb0c46
--- /dev/null
+++ b/qt5-entitlements.xml
@@ -0,0 +1,18 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "https://www.apple.com/DTDs/PropertyList-1.0.dtd">
+<plist version="1.0">
+  <dict>
+    <key>com.apple.security.cs.allow-jit</key>
+    <true/>
+    <key>com.apple.security.device-access</key>
+    <true/>
+    <key>com.apple.security.hypervisor</key>
+    <true/>
+    <key>com.apple.security.networking</key>
+    <true/>
+    <key>com.apple.security.cs.allow-unsigned-executable-memory</key>
+    <true/>
+    <key>com.apple.security.cs.disable-executable-page-protection</key>
+    <true/>
+  </dict>
+</plist>
diff --git a/target/i386/cpu.c b/target/i386/cpu.c
index b6ae8c790a..ceee9c06b6 100644
--- a/target/i386/cpu.c
+++ b/target/i386/cpu.c
@@ -5053,11 +5053,16 @@ static void x86_cpu_update_enable_features(X86CPUDefinition *cpus,
 {
     X86CPUDefinition *cpu = x86_cpu_find(cpus, cpus_size, cpu_name);
     if (cpu) {
+#ifdef CONFIG_HVF
         uint32_t eax, ebx, ecx, edx;
         host_cpuid(1, 0, &eax, &ebx, &ecx, &edx);
 
         cpu->features[FEAT_1_ECX] |= (ecx & extra_ecx);
         cpu->features[FEAT_1_EDX] |= (edx & extra_edx);
+#else
+        cpu->features[FEAT_1_ECX] |= extra_ecx;
+        cpu->features[FEAT_1_EDX] |= extra_edx;
+#endif
     }
 }
 
@@ -5070,9 +5075,11 @@ static void x86_cpu_register_types(void)
                                    /* Extra ECX bits */
                                    CPUID_EXT_AES |
                                    CPUID_EXT_PCLMULQDQ |
-                                   CPUID_EXT_XSAVE |
+                                   CPUID_EXT_XSAVE,
+                                   /* TCG doesn't support these
                                    CPUID_EXT_AVX |
                                    CPUID_EXT_F16C,
+                                   */
                                    /* Extra EDX bits */
                                    CPUID_FXSR
     );
diff --git a/util/osdep.c b/util/osdep.c
index b98e28c4f1..5d1a1cb61b 100644
--- a/util/osdep.c
+++ b/util/osdep.c
@@ -110,6 +110,12 @@ int qemu_mprotect_none(void *addr, size_t size)
 #ifdef _WIN32
     return qemu_mprotect__osdep(addr, size, PAGE_NOACCESS);
 #else
+#if defined(__APPLE__) && defined(__arm64__)
+    if (__builtin_available(macOS 11.2, *)) {
+        /* mprotect() in macOS 11.2 can't switch RWX to NONE */
+        return 0;
+    }
+#endif
     return qemu_mprotect__osdep(addr, size, PROT_NONE);
 #endif
 }
